# clangd configuration for FlashInfer+ROCm

CompileFlags:
  Add:
    # Project includes (relative to workspace root where .clangd is located)
    - "-I${workspaceFolder}/include"

    # C++ standard
    - "-std=c++20"

    # Treat files as HIP source (works for both .cu and .cuh files)
    - "-x"
    - "hip"

    - "-DPLATFORM_HIP_DEVICE"
    - "-D__HIP__"
    - "-D__HIPCC__"
    - "-D__HIP_PLATFORM_AMD__"
    - "-DFLASHINFER_ENABLE_HIP"
    - "-I/opt/rocm/include"

  # Use compile_commands.json from the project root (clangd searches upward from source files)
  CompilationDatabase: .

  # Remove problematic flags that might come from compile_commands.json
  Remove:
    - "-forward-unknown-to-host-compiler"
    - "--generate-code*"
    - "-Werror*"
    - "-DPLATFORM_CUDA_DEVICE"
    - "-D__CUDACC__"
    - "-D__CUDA_ARCH__"

# Diagnostics configuration
Diagnostics:
  UnusedIncludes: None
  MissingIncludes: Relaxed
  Suppress:
    - pp_file_not_found
    - drv_unknown_argument
